generator client {
  provider = "prisma-client-js"
  binaryTargets   = ["native"]
}

generator jsonSchema {
  provider = "prisma-json-schema-generator"
  output   = "../prisma/json-schema"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

/// 사용자 정보
model User {
  userId            String    @id @default(uuid()) @map("user_id")
  refreshToken      String?   @db.Text @map("refresh_tkn")
  lastProviderName  String?   @db.VarChar(50) @map("last_prvdr_nm")
  lastLoginAt       DateTime? @updatedAt @db.DateTime(0) @map("last_login_dt")
  createdAt         DateTime? @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt         DateTime? @updatedAt @db.DateTime(0) @map("updt_dt")

  userSoc        UserSoc[]
  wedd           Wedd[]

  @@map("user")
}

/// 소셜 로그인 계정
model UserSoc {
  providerName    String    @db.VarChar(50) @map("prvdr_nm")
  providerUserId  String    @db.VarChar(100) @map("prvdr_user_id")
  userId          String    @db.VarChar(100) @map("user_id")
  socialId        String?   @db.VarChar(100) @map("soc_id")
  accessToken     String?   @db.Text @map("access_tkn")
  refreshToken    String?   @db.Text @map("refresh_tkn")
  idToken         String?   @db.Text @map("id_tkn")
  tokenExpiredAt  DateTime? @db.DateTime(0) @map("tkn_expr_dt")
  scope           String?   @db.VarChar(100) @map("scope")
  createdAt       DateTime? @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt       DateTime? @updatedAt @db.DateTime(0) @map("updt_dt")

  user            User      @relation(fields: [userId], references: [userId])

  @@id([providerName, providerUserId])
  @@map("user_soc")
}

/// 청첩장 기본정보
model Wedd {
  weddingId       Int         @default(autoincrement()) @id @map("wedd_id")
  userId          String      @map("user_id")
  weddingTitle    String?     @db.VarChar(50) @map("wedd_ttl")
  weddingSlug     String?     @db.VarChar(100) @map("wedd_slug")
  createdAt       DateTime?   @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt       DateTime?   @updatedAt @db.DateTime(0) @map("updt_dt")

  user            User        @relation(fields: [userId], references: [userId])
  weddDtl         WeddDtl?
  WeddSectSet     WeddSectSet[]

  @@map("wedd")
}

/// 청첩장 상세정보
model WeddDtl {
  weddingId                        Int        @id @map("wedd_id")

  mainPosterStyle                  String?    @db.VarChar(50) @map("main_poster_styl")

  shareLinkTitle                   String?    @db.VarChar(50) @map("shr_ttl")

  weddingInfoGroomLastName        String?    @db.VarChar(50) @map("info_grm_last_nm")
  weddingInfoGroomFirstName       String?    @db.VarChar(50) @map("info_grm_first_nm")
  weddingInfoBrideLastName        String?    @db.VarChar(50) @map("info_brd_last_nm")
  weddingInfoBrideFirstName       String?    @db.VarChar(50) @map("info_brd_first_nm")
  weddingInfoNameOrderType        String?    @db.VarChar(1)  @map("info_nm_ordr_se")
  weddingInfoDate                 String?    @db.VarChar(8)  @map("info_wedd_de")
  weddingInfoTimePeriod           String?    @db.VarChar(10) @map("info_wedd_tm_pd")
  weddingInfoTime                 String?    @db.VarChar(4)  @map("info_wedd_tm")
  weddingInfoHallName             String?    @db.VarChar(50) @map("info_hall_nm")
  weddingInfoHallFloor            String?    @db.VarChar(50) @map("info_hall_flr")

  familyInfoGroomFatherName       String?    @db.VarChar(50) @map("prnt_grm_fthr_nm")
  familyInfoGroomFatherDeceased   Boolean?                   @map("prnt_grm_fthr_deceased_yn")
  familyInfoGroomMotherName       String?    @db.VarChar(50) @map("prnt_grm_mthr_nm")
  familyInfoGroomMotherDeceased   Boolean?                   @map("prnt_grm_mthr_deceased_yn")
  familyInfoGroomRankName         String?    @db.VarChar(50) @map("prnt_grm_rank_nm")
  familyInfoBrideFatherName       String?    @db.VarChar(50) @map("prnt_brd_fthr_nm")
  familyInfoBrideFatherDeceased   Boolean?                   @map("prnt_brd_fthr_deceased_yn")
  familyInfoBrideMotherName       String?    @db.VarChar(50) @map("prnt_brd_mthr_nm")
  familyInfoBrideMotherDeceased   Boolean?                   @map("prnt_brd_mthr_deceased_yn")
  familyInfoBrideRankName         String?    @db.VarChar(50) @map("prnt_brd_rank_nm")

  invitationMessageTitle          String?    @db.VarChar(50) @map("inv_ttl")
  invitationMessageContent        String?    @db.Text        @map("inv_msg")

  coupleIntroTitle                String?    @db.VarChar(50) @map("intr_ttl")
  coupleIntroGroomMessage         String?    @db.Text        @map("intr_grm_msg")
  coupleIntroBrideMessage         String?    @db.Text        @map("intr_brd_msg")

  parentsIntroTitle               String?    @db.VarChar(50) @map("prnt_intr_ttl")
  parentsIntroMessage             String?    @db.Text        @map("prnt_intr_msg")

  accountInfoTitle                String?    @db.VarChar(50) @map("acnt_ttl")
  accountInfoMessage              String?    @db.Text        @map("acnt_msg")
  accountInfoGroomBankName        String?    @db.VarChar(10) @map("acnt_grm_bnk_nm")
  accountInfoGroomNumber          String?    @db.VarChar(20) @map("acnt_grm_no")
  accountInfoGroomHolder          String?    @db.VarChar(50) @map("acnt_grm_hldr_nm")
  accountInfoGroomFatherBankName  String?    @db.VarChar(10) @map("acnt_grm_fthr_bnk_nm")
  accountInfoGroomFatherNumber    String?    @db.VarChar(20) @map("acnt_grm_fthr_no")
  accountInfoGroomFatherHolder    String?    @db.VarChar(50) @map("acnt_grm_fthr_hldr_nm")
  accountInfoGroomMotherBankName  String?    @db.VarChar(10) @map("acnt_grm_mthr_bnk_nm")
  accountInfoGroomMotherNumber    String?    @db.VarChar(20) @map("acnt_grm_mthr_no")
  accountInfoGroomMotherHolder    String?    @db.VarChar(50) @map("acnt_grm_mthr_hldr_nm")
  accountInfoBrideBankName        String?    @db.VarChar(10) @map("acnt_brd_bnk_nm")
  accountInfoBrideNumber          String?    @db.VarChar(20) @map("acnt_brd_no")
  accountInfoBrideHolder          String?    @db.VarChar(50) @map("acnt_brd_hldr_nm")
  accountInfoBrideFatherBankName  String?    @db.VarChar(10) @map("acnt_brd_fthr_bnk_nm")
  accountInfoBrideFatherNumber    String?    @db.VarChar(20) @map("acnt_brd_fthr_no")
  accountInfoBrideFatherHolder    String?    @db.VarChar(50) @map("acnt_brd_fthr_hldr_nm")
  accountInfoBrideMotherBankName  String?    @db.VarChar(10) @map("acnt_brd_mthr_bnk_nm")
  accountInfoBrideMotherNumber    String?    @db.VarChar(20) @map("acnt_brd_mthr_no")
  accountInfoBrideMotherHolder    String?    @db.VarChar(50) @map("acnt_brd_mthr_hldr_nm")

  locationInfoAddress             String?    @db.VarChar(100) @map("loc_addr")
  locationInfoAddressDetail       String?    @db.VarChar(100) @map("loc_addr_dtl")
  locationInfoGuideMessage        String?    @db.Text        @map("loc_guide_msg")
  locationInfoTransport1Title     String?    @db.VarChar(50) @map("loc_trans_1_ttl")
  locationInfoTransport1Message   String?    @db.Text        @map("loc_trans_1_msg")
  locationInfoTransport2Title     String?    @db.VarChar(50) @map("loc_trans_2_ttl")
  locationInfoTransport2Message   String?    @db.Text        @map("loc_trans_2_msg")
  locationInfoTransport3Title     String?    @db.VarChar(50) @map("loc_trans_3_ttl")
  locationInfoTransport3Message   String?    @db.Text        @map("loc_trans_3_msg")

  themeFontName                   String?    @db.VarChar(50) @map("theme_font_nm")
  themeFontSize                   Int?                       @map("theme_font_size")
  themeFontBackgroundColor        String?    @db.VarChar(20) @map("theme_bg_color")
  themeFontAccentColor            String?    @db.VarChar(20) @map("theme_accent_color")
  themeFontZoomPreventYn          Boolean?                   @map("theme_zoom_prevent_yn")

  loadingScreenStyle              String?    @db.VarChar(50) @map("load_styl")

  galleryTitle                    String?    @db.VarChar(50) @map("glly_ttl")

  createdAt                       DateTime?  @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt                       DateTime?  @updatedAt @db.DateTime(0)      @map("updt_dt")

  wedd                            Wedd       @relation(fields: [weddingId], references: [weddingId])
  weddMedia                       WeddMedia[]

  @@map("wedd_dtl")
}


/// 이미지 통합 테이블
model WeddMedia {
  weddingId     Int       @map("wedd_id")
  mediaId       Int       @map("media_id")
  imageType     String?   @db.VarChar(50) @map("img_type")
  displayOrder  Int?      @map("display_ordr")
  originalUrl   String?   @db.VarChar(255) @map("org_url")
  editedUrl     String?   @db.VarChar(255) @map("edit_url")
  fileExtension String?   @db.VarChar(10) @map("file_extsn")
  fileSize      Int?      @map("file_size")
  createdAt     DateTime? @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt     DateTime? @updatedAt @db.DateTime(0) @map("updt_dt")

  weddDtl       WeddDtl   @relation(fields: [weddingId], references: [weddingId])

  @@id([weddingId, mediaId])
  @@map("wedd_media")
}

/// 섹션 순서 관리
model WeddSectSet {
  weddingId     Int       @map("wedd_id")
  sectionKey    String    @db.VarChar(50) @map("sect_key")
  displayYn     Boolean?  @map("display_yn")
  displayOrder  Int?      @map("display_ordr")
  createdAt     DateTime? @default(now()) @db.DateTime(0) @map("creat_dt")
  updatedAt     DateTime? @updatedAt @db.DateTime(0) @map("updt_dt")

  wedd          Wedd      @relation(fields: [weddingId], references: [weddingId])

  @@id([weddingId, sectionKey])
  @@map("wedd_sect_set")
}